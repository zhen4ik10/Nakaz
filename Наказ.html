<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è –Ω–∞–∫–∞–∑—ñ–≤ - –ú–∞–∫–µ—Ç</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .form-panel {
            background: white;
            border: 2px solid #333;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .form-header {
            background-color: #4472C4;
            color: white;
            padding: 10px;
            margin: -15px -15px 15px -15px;
            border-radius: 3px 3px 0 0;
            font-weight: bold;
        }

        .form-row {
            display: flex;
            margin-bottom: 10px;
            align-items: center;
        }

        .form-label {
            width: 150px;
            font-weight: bold;
            color: #333;
        }

        .form-input {
            flex: 1;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
            margin-right: 10px;
        }

        .form-button {
            background-color: #5B9BD5;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 3px;
            cursor: pointer;
            margin: 5px;
        }

        .form-button:hover {
            background-color: #4472C4;
        }

        .form-button.danger {
            background-color: #E74C3C;
        }

        .form-button.success {
            background-color: #27AE60;
        }

        .order-content {
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            margin-top: 10px;
            font-family: 'Times New Roman', serif;
            line-height: 1.5;
        }

        .order-header {
            text-align: center;
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .order-section {
            margin-bottom: 15px;
        }

        .section-title {
            background-color: #FF6B6B;
            color: white;
            padding: 5px 10px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .order-point {
            margin-bottom: 10px;
            padding-left: 20px;
        }

        .point-number {
            font-weight: bold;
        }

        .highlighted-text {
            background-color: #90EE90;
            padding: 2px 4px;
        }

        .navigation-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }

        .step-indicator {
            background: #17a2b8;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
        }

        .demo-note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            color: #856404;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="demo-note">
            <strong>üìã –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ä–æ–±–æ—Ç–∏ —Å–∏—Å—Ç–µ–º–∏ —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è –Ω–∞–∫–∞–∑—ñ–≤</strong><br>
            –¶–µ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –º–∞–∫–µ—Ç, —è–∫–∏–π –ø–æ–∫–∞–∑—É—î, —è–∫ –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –≤ Access
        </div>

        <!-- –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –Ω–∞–∫–∞–∑—É -->
        <div class="form-panel" id="step1">
            <div class="form-header">–ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –Ω–∞–∫–∞–∑—É</div>
            <div class="form-row">
                <div class="form-label">–ù–æ–º–µ—Ä –Ω–∞–∫–∞–∑—É:</div>
                <input type="text" class="form-input" value="156" id="orderNumber">
            </div>
            <div class="form-row">
                <div class="form-label">–î–∞—Ç–∞ –Ω–∞–∫–∞–∑—É:</div>
                <input type="date" class="form-input" value="2025-05-22" id="orderDate">
            </div>
            <div class="form-row">
                <div class="form-label">–•—Ç–æ –ø—ñ–¥–ø–∏—Å—É—î:</div>
                <input type="text" class="form-input" value="–ö–æ–º–∞–Ω–¥–∏—Ä –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏" id="signedBy">
            </div>
            <div class="form-row">
                <div class="form-label"></div>
                <button class="form-button success" onclick="goToStep2()">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –Ω–∞–∫–∞–∑—É</button>
            </div>
        </div>

        <!-- –ö—Ä–æ–∫ 2: –ì–æ–ª–æ–≤–Ω–∞ —Ñ–æ—Ä–º–∞ –Ω–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –Ω–∞–∫–∞–∑—É -->
        <div class="form-panel" id="step2" style="display: none;">
            <div class="form-header">–ö—Ä–æ–∫ 2: –ù–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –Ω–∞–∫–∞–∑—É ‚Ññ 156 –≤—ñ–¥ 22.05.2025</div>

            <div class="navigation-panel">
                <div class="step-indicator">–î–æ–¥–∞–≤–∞–Ω–Ω—è –ø—É–Ω–∫—Ç—ñ–≤ –¥–æ –Ω–∞–∫–∞–∑—É</div>
                <div>
                    <button class="form-button" onclick="showAddPointForm()">‚ûï –î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π –ø—É–Ω–∫—Ç</button>
                    <button class="form-button" onclick="generateOrder()">üìÑ –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –Ω–∞–∫–∞–∑</button>
                </div>
            </div>

            <div style="margin-top: 15px;">
                <div class="form-row">
                    <div class="form-label">–¢–∏–ø –±–ª–æ–∫—É:</div>
                    <select class="form-input" id="blockType">
                        <option value="">–í–∏–±–µ—Ä—ñ—Ç—å —Ç–∏–ø –±–ª–æ–∫—É...</option>
                        <option value="arrival">–í–≤–∞–∂–∞—Ç–∏ —Ç–∞–∫–∏–º–∏, —â–æ –ø—Ä–∏–±—É–ª–∏ —Ç–∞ –ø—Ä–∏—Å—Ç—É–ø–∏–ª–∏ –¥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–ª—É–∂–±–æ–≤–∏—Ö
                            –æ–±–æ–≤'—è–∑–∫—ñ–≤</option>
                        <option value="departure">–í–≤–∞–∂–∞—Ç–∏ —Ç–∞–∫–∏–º–∏, —â–æ –≤–∏–±—É–ª–∏</option>
                    </select>
                    <button class="form-button" onclick="showAddPointForm()">–î–æ–¥–∞—Ç–∏ –ø—É–Ω–∫—Ç</button>
                </div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –¥–æ–¥–∞–Ω–∏—Ö –ø—É–Ω–∫—Ç—ñ–≤ -->
            <div class="order-content" id="addedPoints">
                <div class="order-header">–î–æ–¥–∞–Ω—ñ –ø—É–Ω–∫—Ç–∏ –Ω–∞–∫–∞–∑—É:</div>
                <div id="pointsList">
                    <em>–ü–æ–∫–∏ —â–æ –ø—É–Ω–∫—Ç—ñ–≤ –Ω–µ–º–∞—î. –î–æ–¥–∞–π—Ç–µ –ø–µ—Ä—à–∏–π –ø—É–Ω–∫—Ç.</em>
                </div>
            </div>
        </div>

        <!-- –ö—Ä–æ–∫ 3: –§–æ—Ä–º–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø—É–Ω–∫—Ç—É -->
        <div class="form-panel" id="step3" style="display: none;">
            <div class="form-header">–ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø—É–Ω–∫—Ç—É –¥–æ –Ω–∞–∫–∞–∑—É</div>

            <div class="form-row">
                <div class="form-label">–¢–∏–ø –ø—É–Ω–∫—Ç—É:</div>
                <select class="form-input" id="pointType" onchange="showPointFields()">
                    <option value="">–í–∏–±–µ—Ä—ñ—Ç—å —Ç–∏–ø –ø—É–Ω–∫—Ç—É...</option>
                    <option value="business_trip">–ó –≤—ñ–¥—Ä—è–¥–∂–µ–Ω–Ω—è</option>
                    <option value="vacation">–ó –≤—ñ–¥–ø—É—Å—Ç–∫–∏ –∑–∞ —Å—ñ–º–µ–π–Ω–∏–º–∏ –æ–±—Å—Ç–∞–≤–∏–Ω–∞–º–∏</option>
                    <option value="hospital">–ó –≥–æ—Å–ø—ñ—Ç–∞–ª—é/–ª—ñ–∫–∞—Ä–Ω—ñ</option>
                </select>
            </div>

            <div class="form-row">
                <div class="form-label">–ù–æ–º–µ—Ä –ø—É–Ω–∫—Ç—É:</div>
                <input type="text" class="form-input" value="2.1" readonly id="pointNumber">
            </div>

            <!-- –ü–æ–ª—è –¥–ª—è –≤–∏–±–æ—Ä—É –æ—Å–æ–±–∏ -->
            <div class="form-row">
                <div class="form-label">–ü—Ä—ñ–∑–≤–∏—â–µ:</div>
                <select class="form-input" id="personSelect" onchange="fillPersonData()">
                    <option value="">–í–∏–±–µ—Ä—ñ—Ç—å –æ—Å–æ–±—É...</option>
                    <option value="1">–ù–Ü–ö–û–ù–û–í –î–º–∏—Ç—Ä–æ –í–∞–ª–µ—Ä—ñ–π–æ–≤–∏—á</option>
                    <option value="2">–ü–ï–¢–†–ï–ù–ö–û –Ü–≤–∞–Ω –Ü–≤–∞–Ω–æ–≤–∏—á</option>
                    <option value="3">–°–ò–î–û–†–ï–ù–ö–û –û–ª–µ–∫—Å–∞–Ω–¥—Ä –ü–µ—Ç—Ä–æ–≤–∏—á</option>
                </select>
            </div>

            <div class="form-row">
                <div class="form-label">–ó–≤–∞–Ω–Ω—è:</div>
                <input type="text" class="form-input" id="rank" readonly>
            </div>

            <div class="form-row">
                <div class="form-label">–ü–æ—Å–∞–¥–∞:</div>
                <input type="text" class="form-input" id="position" readonly>
            </div>

            <!-- –î–æ–¥–∞—Ç–∫–æ–≤—ñ –ø–æ–ª—è –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–∏–ø—É –ø—É–Ω–∫—Ç—É -->
            <div id="additionalFields" style="display: none;">
                <div class="form-row" id="dateField">
                    <div class="form-label">–î–∞—Ç–∞:</div>
                    <input type="date" class="form-input" id="eventDate">
                </div>

                <div class="form-row" id="unitField">
                    <div class="form-label">–í—ñ–π—Å—å–∫–æ–≤–∞ —á–∞—Å—Ç–∏–Ω–∞:</div>
                    <input type="text" class="form-input" id="militaryUnit" value="–ê7323">
                </div>

                <div class="form-row" id="weaponField">
                    <div class="form-label">–û—Å–æ–±–∏—Å—Ç–∞ –∑–±—Ä–æ—è:</div>
                    <input type="text" class="form-input" id="weapon" value="–¢–¢ ‚Ññ –ü–ê446">
                </div>
            </div>

            <!-- –°—Ñ–æ—Ä–º–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç -->
            <div class="form-row">
                <div class="form-label">–°—Ñ–æ—Ä–º–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç:</div>
                <textarea class="form-input" id="generatedText" rows="4" readonly
                    placeholder="–¢–µ–∫—Å—Ç –±—É–¥–µ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ—Å–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –≤—Å—ñ—Ö –ø–æ–ª—ñ–≤"></textarea>
            </div>

            <div class="form-row">
                <div class="form-label"></div>
                <button class="form-button" onclick="generateText()">üîÑ –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç</button>
                <button class="form-button success" onclick="addPointToOrder()">‚úÖ –î–æ–¥–∞—Ç–∏ –¥–æ –Ω–∞–∫–∞–∑—É</button>
                <button class="form-button danger" onclick="cancelAddPoint()">‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
            </div>
        </div>

        <!-- –ö—Ä–æ–∫ 4: –ì–æ—Ç–æ–≤–∏–π –Ω–∞–∫–∞–∑ -->
        <div class="form-panel" id="step4" style="display: none;">
            <div class="form-header">–ö—Ä–æ–∫ 4: –ì–æ—Ç–æ–≤–∏–π –Ω–∞–∫–∞–∑</div>

            <div class="navigation-panel">
                <div class="step-indicator">–ù–∞–∫–∞–∑ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–æ</div>
                <div>
                    <button class="form-button" onclick="printOrder()">üñ®Ô∏è –†–æ–∑–¥—Ä—É–∫—É–≤–∞—Ç–∏</button>
                    <button class="form-button" onclick="editOrder()">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
                    <button class="form-button success" onclick="startNewOrder()">üìã –ù–æ–≤–∏–π –Ω–∞–∫–∞–∑</button>
                </div>
            </div>

            <div class="order-content" id="finalOrder">
                <div class="order-header">
                    –ù–ê–ö–ê–ó<br>
                    –∫–æ–º–∞–Ω–¥–∏—Ä–∞ –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏ –ê7323<br>
                    ‚Ññ 156 –≤—ñ–¥ 22 —Ç—Ä–∞–≤–Ω—è 2025 —Ä–æ–∫—É
                </div>

                <div class="order-section">
                    <div class="section-title">–í–≤–∞–∂–∞—Ç–∏ —Ç–∞–∫–∏–º–∏, —â–æ –ø—Ä–∏–±—É–ª–∏ —Ç–∞ –ø—Ä–∏—Å—Ç—É–ø–∏–ª–∏ –¥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–ª—É–∂–±–æ–≤–∏—Ö
                        –æ–±–æ–≤'—è–∑–∫—ñ–≤:</div>

                    <div class="order-point">
                        <span class="point-number">2.1.</span> –î–æ –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏ –ê7323, –∑ 14 –∫–≤—ñ—Ç–Ω—è 2025 —Ä–æ–∫—É –¥–æ
                        –æ–∫—Ä–µ–º–æ–≥–æ —Ä–æ–∑–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è:
                        <span class="highlighted-text">–º–∞–π–æ—Ä–∞ –ù–Ü–ö–û–ù–û–í–ê –î–º–∏—Ç—Ä–∞ –í–∞–ª–µ—Ä—ñ–π–æ–≤–∏—á–∞</span>, –ö–æ–º–∞–Ω–¥–∏—Ä–∞ –≤—ñ–π—Å—å–∫–æ–≤–æ—ó
                        —á–∞—Å—Ç–∏–Ω–∏ –ê7046, –æ–∑–±—Ä–æ—î–Ω–æ–≥–æ –ø—ñ—Å—Ç–æ–ª–µ—Ç –¢–¢ ‚Ññ
                        –ü–ê446.
                        –ó–∞—Ä–∞—Ö—É–≤–∞—Ç–∏ –º–∞–π–æ—Ä–∞ –ù—ñ–∫–æ–Ω–æ–≤–∞ –†.–í. –Ω–∞ –ø—Ä–æ–¥–æ–≤–æ–ª—å—á–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–º (3-—Ö —Ä–∞–∑–æ–≤–µ —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è)
                        –∑ 15 –∫–≤—ñ—Ç–Ω—è 2025 —Ä–æ–∫—É –ø—Ä–∏ –≤—ñ–π—Å—å–∫–æ–≤—ñ–π —á–∞—Å—Ç–∏–Ω—ñ –ê7323.
                        <br><strong>–ü—ñ–¥—Å—Ç–∞–≤–∞:</strong> –Ω–∞–∫–∞–∑ –∫–æ–º–∞–Ω–¥–∏—Ä–∞ –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏ –ê7046 ‚Ññ112 –≤—ñ–¥ 12.04.2025;
                        –ø–æ—Å–≤—ñ–¥—á–µ–Ω–Ω—è –ø—Ä–æ –≤—ñ–¥—Ä—è–¥–∂–µ–Ω–Ω—è ‚Ññ 793–≤—ñ–¥ 12.04.2025.
                    </div>

                    <div class="order-point">
                        <span class="point-number">2.2.</span> –ó –≤—ñ–¥–ø—É—Å—Ç–∫–∏ –∑–∞ —Å—ñ–º–µ–π–Ω–∏–º–∏ –æ–±—Å—Ç–∞–≤–∏–Ω–∞–º–∏, –∑ 14 –∫–≤—ñ—Ç–Ω—è 2025
                        —Ä–æ–∫—É:
                        <span class="highlighted-text">—Å–µ—Ä–∂–∞–Ω—Ç–∞ –ó–ê–¢–†–ï–ë–ï–õ–¨–ù–£ –ù–∞–¥—ñ—é –û–ª–µ–∫—Å—ñ—ó–≤–Ω—É</span>, —Å–µ—Ä–∂–∞–Ω—Ç–∞ —ñ–∑
                        –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è 2 —Å—Ç—Ä—ñ–ª–µ—Ü—å–∫–æ—ó —Ä–æ—Ç–∏ –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏ –ê7323, –∑ –≤—ñ–¥–ø—É—Å—Ç–∫–∏ –∑–∞ —Å—ñ–º–µ–π–Ω–∏–º–∏
                        –æ–±—Å—Ç–∞–≤–∏–Ω–∞–º–∏ 14 –∫–≤—ñ—Ç–Ω—è 2025 —Ä–æ–∫—É.
                        –ó–∞—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–µ—Ä–∂–∞–Ω—Ç–∞ –ó–∞—Ç—Ä–µ–±–µ–ª—å–Ω—É –ù. –Ω–∞ –ø—Ä–æ–¥–æ–≤–æ–ª—å—á–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–º (3-—Ö —Ä–∞–∑–æ–≤–µ
                        —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è) 15 –∫–≤—ñ—Ç–Ω—è 2025 —Ä–æ–∫—É –ø—Ä–∏ –≤—ñ–π—Å—å–∫–æ–≤—ñ–π —á–∞—Å—Ç–∏–Ω—ñ –ê7323.
                        <br><strong>–ü—ñ–¥—Å—Ç–∞–≤–∞:</strong> –≤—ñ–¥–ø—É—Å–∫–Ω–∏–π –∫–≤–∏—Ç–æ–∫ —Å–µ—Ä–∂–∞–Ω—Ç–∞ –ù. –ó–∞—Ç—Ä–µ–±–µ–ª—å–Ω—É –≤—ñ–¥ 01 –∫–≤—ñ—Ç–Ω—è 2025 —Ä–æ–∫—É
                        ‚Ññ67.
                    </div>
                </div>

                <div style="margin-top: 40px; text-align: right;">
                    –ö–æ–º–∞–Ω–¥–∏—Ä –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏ –ê7323<br>
                    <div style="margin-top: 20px;">___________________ (–ø—ñ–¥–ø–∏—Å)</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let addedPoints = [];

        function goToStep2() {
            document.getElementById('step1').style.display = 'none';
            document.getElementById('step2').style.display = 'block';
            currentStep = 2;
        }

        function showAddPointForm() {
            const blockType = document.getElementById('blockType').value;
            if (!blockType) {
                alert('–°–ø–æ—á–∞—Ç–∫—É –≤–∏–±–µ—Ä—ñ—Ç—å —Ç–∏–ø –±–ª–æ–∫—É!');
                return;
            }

            document.getElementById('step2').style.display = 'none';
            document.getElementById('step3').style.display = 'block';
            currentStep = 3;
        }

        function showPointFields() {
            const pointType = document.getElementById('pointType').value;
            const additionalFields = document.getElementById('additionalFields');

            if (pointType) {
                additionalFields.style.display = 'block';

                // –ü–æ–∫–∞–∑–∞—Ç–∏/–ø—Ä–∏—Ö–æ–≤–∞—Ç–∏ –ø–æ–ª—è –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–∏–ø—É
                document.getElementById('dateField').style.display = 'flex';
                document.getElementById('unitField').style.display = pointType === 'business_trip' ? 'flex' : 'none';
                document.getElementById('weaponField').style.display = pointType === 'business_trip' ? 'flex' : 'none';
            } else {
                additionalFields.style.display = 'none';
            }
        }

        function fillPersonData() {
            const personId = document.getElementById('personSelect').value;
            const rankField = document.getElementById('rank');
            const positionField = document.getElementById('position');

            // –°–∏–º—É–ª—è—Ü—ñ—è –∞–≤—Ç–æ–∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ –±–∞–∑–∏
            if (personId === '1') {
                rankField.value = '–º–∞–π–æ—Ä';
                positionField.value = '–Ω–∞—á–∞–ª—å–Ω–∏–∫ —Å–ª—É–∂–±–∏ –ø–∞–ª—å–Ω–æ-–º–∞—Å—Ç–∏–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤';
            } else if (personId === '2') {
                rankField.value = '–ª–µ–π—Ç–µ–Ω–∞–Ω—Ç';
                positionField.value = '–∫–æ–º–∞–Ω–¥–∏—Ä –≤–∑–≤–æ–¥—É';
            } else if (personId === '3') {
                rankField.value = '—Å–µ—Ä–∂–∞–Ω—Ç';
                positionField.value = '—Å–µ—Ä–∂–∞–Ω—Ç —ñ–∑ –º–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è';
            }
        }

        function generateText() {
            const pointType = document.getElementById('pointType').value;
            const person = document.getElementById('personSelect').selectedOptions[0]?.text;
            const rank = document.getElementById('rank').value;
            const position = document.getElementById('position').value;
            const eventDate = document.getElementById('eventDate').value;
            const unit = document.getElementById('militaryUnit').value;
            const weapon = document.getElementById('weapon').value;

            if (!pointType || !person || !rank) {
                alert('–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –æ–±–æ–≤\'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è!');
                return;
            }

            let generatedText = '';

            if (pointType === 'business_trip') {
                generatedText = `–î–æ –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏ ${unit}, ${formatDate(eventDate)} —Ä–æ–∫—É –¥–æ –æ–∫—Ä–µ–º–æ–≥–æ —Ä–æ–∑–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è: ${rank} ${person}, ${position} –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏ –ê7046, –æ–∑–±—Ä–æ—î–Ω–∏–π –ø—ñ—Å—Ç–æ–ª–µ—Ç ${weapon}.`;
            } else if (pointType === 'vacation') {
                generatedText = `–ó –≤—ñ–¥–ø—É—Å—Ç–∫–∏ –∑–∞ —Å—ñ–º–µ–π–Ω–∏–º–∏ –æ–±—Å—Ç–∞–≤–∏–Ω–∞–º–∏, –∑ ${formatDate(eventDate)} —Ä–æ–∫—É: ${rank} ${person}, ${position} –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏ ${unit}, –∑ –≤—ñ–¥–ø—É—Å—Ç–∫–∏ –∑–∞ —Å—ñ–º–µ–π–Ω–∏–º–∏ –æ–±—Å—Ç–∞–≤–∏–Ω–∞–º–∏ ${formatDate(eventDate)} —Ä–æ–∫—É.`;
            }

            document.getElementById('generatedText').value = generatedText;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            return date.getDate() + ' ' +
                ['—Å—ñ—á–Ω—è', '–ª—é—Ç–æ–≥–æ', '–±–µ—Ä–µ–∑–Ω—è', '–∫–≤—ñ—Ç–Ω—è', '—Ç—Ä–∞–≤–Ω—è', '—á–µ—Ä–≤–Ω—è',
                    '–ª–∏–ø–Ω—è', '—Å–µ—Ä–ø–Ω—è', '–≤–µ—Ä–µ—Å–Ω—è', '–∂–æ–≤—Ç–Ω—è', '–ª–∏—Å—Ç–æ–ø–∞–¥–∞', '–≥—Ä—É–¥–Ω—è'][date.getMonth()] + ' ' +
                date.getFullYear();
        }

        function addPointToOrder() {
            const generatedText = document.getElementById('generatedText').value;
            const pointNumber = document.getElementById('pointNumber').value;

            if (!generatedText) {
                alert('–°–ø–æ—á–∞—Ç–∫—É —Å—Ñ–æ—Ä–º—É–π—Ç–µ —Ç–µ–∫—Å—Ç!');
                return;
            }

            addedPoints.push({
                number: pointNumber,
                text: generatedText
            });

            updatePointsList();
            cancelAddPoint();
        }

        function updatePointsList() {
            const pointsList = document.getElementById('pointsList');

            if (addedPoints.length === 0) {
                pointsList.innerHTML = '<em>–ü–æ–∫–∏ —â–æ –ø—É–Ω–∫—Ç—ñ–≤ –Ω–µ–º–∞—î. –î–æ–¥–∞–π—Ç–µ –ø–µ—Ä—à–∏–π –ø—É–Ω–∫—Ç.</em>';
            } else {
                pointsList.innerHTML = addedPoints.map(point =>
                    `<div class="order-point">
                        <span class="point-number">${point.number}.</span> ${point.text}
                    </div>`
                ).join('');
            }
        }

        function cancelAddPoint() {
            document.getElementById('step3').style.display = 'none';
            document.getElementById('step2').style.display = 'block';

            // –û—á–∏—Å—Ç–∏—Ç–∏ —Ñ–æ—Ä–º—É
            document.getElementById('pointType').value = '';
            document.getElementById('personSelect').value = '';
            document.getElementById('rank').value = '';
            document.getElementById('position').value = '';
            document.getElementById('generatedText').value = '';
            document.getElementById('additionalFields').style.display = 'none';
        }

        function generateOrder() {
            if (addedPoints.length === 0) {
                alert('–î–æ–¥–∞–π—Ç–µ —Ö–æ—á–∞ –± –æ–¥–∏–Ω –ø—É–Ω–∫—Ç –¥–æ –Ω–∞–∫–∞–∑—É!');
                return;
            }

            document.getElementById('step2').style.display = 'none';
            document.getElementById('step4').style.display = 'block';
        }

        function editOrder() {
            document.getElementById('step4').style.display = 'none';
            document.getElementById('step2').style.display = 'block';
        }

        function startNewOrder() {
            // –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –¥–∞–Ω—ñ —ñ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –ø–æ—á–∞—Ç–∫—É
            addedPoints = [];
            updatePointsList();
            document.getElementById('step4').style.display = 'none';
            document.getElementById('step1').style.display = 'block';

            // –ó–±—ñ–ª—å—à–∏—Ç–∏ –Ω–æ–º–µ—Ä –Ω–∞–∫–∞–∑—É
            const currentNumber = parseInt(document.getElementById('orderNumber').value);
            document.getElementById('orderNumber').value = currentNumber + 1;
        }

        function printOrder() {
            window.print();
        }

        // –î–æ–¥–∞—Ç–∏ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é –∫–ª–∞–≤—ñ—à–∞–º–∏ (—è–∫ –≤–∏ –ø—Ä–æ—Å–∏–ª–∏)
        document.addEventListener('keydown', function (event) {
            if (event.key === 'ArrowLeft' && currentStep > 1) {
                // –õ–æ–≥—ñ–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫—Ä–æ–∫
                console.log('–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫—Ä–æ–∫');
            } else if (event.key === 'ArrowRight' && currentStep < 4) {
                // –õ–æ–≥—ñ–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫
                console.log('–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫');
            }
        });
    </script>
</body>

</html>